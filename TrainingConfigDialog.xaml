<Window x:Class="YoloAnnotator.TrainingConfigDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="训练参数配置" Height="620" Width="560"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundBrush}"
        WindowStyle="None"
        ResizeMode="NoResize">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32" ResizeBorderThickness="{x:Static SystemParameters.WindowResizeBorderThickness}" />
    </WindowChrome.WindowChrome>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="32"/>
            <!-- 自定义标题栏 -->
            <RowDefinition Height="*"/>
            <!-- 主内容区 -->
            <RowDefinition Height="Auto"/>
            <!-- 底部按钮区 -->
        </Grid.RowDefinitions>

        <!-- 自定义标题栏 -->
        <Border Grid.Row="0" Background="{StaticResource TitleBarBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 标题 -->
                <TextBlock Grid.Column="0" Text="训练参数配置" FontWeight="SemiBold" FontSize="12"
                          VerticalAlignment="Center" Margin="12,0" Foreground="{StaticResource TextPrimaryBrush}">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource AncestorType=Window}}" Value="False">
                                    <Setter Property="Foreground" Value="#666666"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

                <!-- 窗口控制按钮 -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button Name="BtnClose" Style="{StaticResource TitleBarCloseButtonStyle}" Click="BtnClose_Click">
                        <Path Data="M0,0 L12,12 M12,0 L0,12" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" StrokeThickness="1.5"
                              Stretch="Uniform" Width="10" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- 主内容区 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20,16">

                <!-- 标题 -->
                <TextBlock Text="训练模型参数配置" FontSize="16" FontWeight="SemiBold" 
                          Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,16"/>

                <!-- Epochs -->
                <StackPanel Margin="0,0,0,12">
                    <TextBlock Text="训练轮数 (Epochs)" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <TextBox Name="TxtEpochs" Text="100" Height="32"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- Batch Size -->
                <StackPanel Margin="0,8,0,12">
                    <TextBlock Text="批次大小 (Batch Size)" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <TextBox Name="TxtBatchSize" Text="16" Height="32"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- Image Size -->
                <StackPanel Margin="0,8,0,12">
                    <TextBlock Text="图片大小 (Image Size)" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <TextBox Name="TxtImageSize" Text="640" Height="32"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- Device -->
                <StackPanel Margin="0,8,0,12">
                    <TextBlock Text="训练设备" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <ComboBox Name="CboDevice" Height="32"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- Model Type -->
                <StackPanel Margin="0,8,0,12">
                    <TextBlock Text="模型类型" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <ComboBox Name="CboModelType" Height="32"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- Weights Path -->
                <StackPanel Margin="0,8,0,12">
                    <TextBlock Text="预训练权重 (可选)" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Name="TxtWeightsPath" Grid.Column="0" Height="32" IsReadOnly="True"/>
                        <Button Name="BtnBrowseWeights" Grid.Column="1" Content="浏览..." Width="80" Height="32" 
                                Margin="8,0,0,0" Style="{StaticResource SecondaryButtonStyle}" Click="BtnBrowseWeights_Click"/>
                    </Grid>
                </StackPanel>

                <!-- CUDA Status -->
                <Border Name="BorderCudaStatus" Background="#2a2a2a" CornerRadius="4" Padding="12,8" Margin="0,8,0,0">
                    <TextBlock Name="TxtCudaStatus" FontSize="11" TextWrapping="Wrap"/>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- 底部按钮区 -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
            <StackPanel Margin="16,12" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Name="BtnCancel" Content="取消" Click="BtnCancel_Click" 
                        Style="{StaticResource SecondaryButtonStyle}" Width="80" Height="32" Margin="0,0,8,0"/>
                <Button Name="BtnOk" Content="开始训练" Click="BtnOk_Click" 
                        Style="{StaticResource PrimaryButtonStyle}" Width="100" Height="32"/>
            </StackPanel>
        </Border>

    </Grid>
</Window>